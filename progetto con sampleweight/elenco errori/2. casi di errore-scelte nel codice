PREMESSA
I PESI NELL'OUTPUT sono sempre per 0 : 0.5 e con 1 : 0.5

SPIEGAZIONE/SCELTE DEL CODICE
======================================================================================================================
se NON espando la dimensione della maschera

train_masks_exp = tf.expand_dims(train_masks, axis=-1)
model.fit(train_images, train_masks, epochs=epoch, batch_size=batch_size,
          callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks,weights),
          validation_data=(val_images, val_masks))

ho questo errore :

Epoch 1/300
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-4-7ca48d57f773> in <cell line: 42>()
     40                                                                     test_size=0.2, random_state=42)
     41 train_masks_exp = tf.expand_dims(train_masks, axis=-1)
---> 42 model.fit(train_images, train_masks, epochs=epoch, batch_size=batch_size,
     43           callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks,weights),
     44           validation_data=(val_images, val_masks))

1 frames
/usr/local/lib/python3.10/dist-packages/keras/engine/training.py in tf__train_function(iterator)
     13                 try:
     14                     do_return = True
---> 15                     retval_ = ag__.converted_call(ag__.ld(step_function), (ag__.ld(self), ag__.ld(iterator)), None, fscope)
     16                 except:
     17                     do_return = False

ValueError: in user code:

    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1284, in train_function  *
        return step_function(self, iterator)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1268, in step_function  **
        outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1249, in run_step  **
        outputs = model.train_step(data)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1051, in train_step
        loss = self.compute_loss(x, y, y_pred, sample_weight)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1109, in compute_loss
        return self.compiled_loss(
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/compile_utils.py", line 265, in __call__
        loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "/usr/local/lib/python3.10/dist-packages/keras/losses.py", line 160, in __call__
        return losses_utils.compute_weighted_loss(
    File "/usr/local/lib/python3.10/dist-packages/keras/utils/losses_utils.py", line 350, in compute_weighted_loss
        ) = squeeze_or_expand_dimensions(losses, None, sample_weight)
    File "/usr/local/lib/python3.10/dist-packages/keras/utils/losses_utils.py", line 224, in squeeze_or_expand_dimensions
        sample_weight = tf.squeeze(sample_weight, [-1])

    ValueError: Can not squeeze dim[2], expected a dimension of 1, got 32 for '{{node binary_crossentropy/weighted_loss/Squeeze}} = Squeeze[T=DT_FLOAT, squeeze_dims=[-1]](IteratorGetNext:2)' with input shapes: [?,32,32].

================================================================================================================================================

se espando la dimensione delle maschere SOLO per il metodo che pesa le maschere ovvero add_sample_weights()
ovvero con :
train_masks_exp = tf.expand_dims(train_masks, axis=-1)
model.fit(train_images, train_masks, epochs=epoch, batch_size=batch_size,
          callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks_exp,weights),
          validation_data=(val_images, val_masks))

ho questo errore:

Epoch 1/300
---------------------------------------------------------------------------
InvalidArgumentError                      Traceback (most recent call last)
<ipython-input-4-48b082c0deba> in <cell line: 42>()
     40                                                                     test_size=0.2, random_state=42)
     41 train_masks_exp = tf.expand_dims(train_masks, axis=-1)
---> 42 model.fit(train_images, train_masks, epochs=epoch, batch_size=batch_size,
     43           callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks_exp,weights),
     44           validation_data=(val_images, val_masks))

1 frames
/usr/local/lib/python3.10/dist-packages/tensorflow/python/eager/execute.py in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)
     50   try:
     51     ctx.ensure_initialized()
---> 52     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
     53                                         inputs, attrs, num_outputs)
     54   except core._NotOkStatusException as e:

InvalidArgumentError: Graph execution error:

Detected at node 'binary_crossentropy/weighted_loss/Mul' defined at (most recent call last):
    File "/usr/lib/python3.10/runpy.py", line 196, in _run_module_as_main
      return _run_code(code, main_globals, None,
    File "/usr/lib/python3.10/runpy.py", line 86, in _run_code
      exec(code, run_globals)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel_launcher.py", line 16, in <module>
      app.launch_new_instance()
    File "/usr/local/lib/python3.10/dist-packages/traitlets/config/application.py", line 992, in launch_instance
      app.start()
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/kernelapp.py", line 619, in start
      self.io_loop.start()
    File "/usr/local/lib/python3.10/dist-packages/tornado/platform/asyncio.py", line 195, in start
      self.asyncio_loop.run_forever()
    File "/usr/lib/python3.10/asyncio/base_events.py", line 603, in run_forever
      self._run_once()
    File "/usr/lib/python3.10/asyncio/base_events.py", line 1909, in _run_once
      handle._run()
    File "/usr/lib/python3.10/asyncio/events.py", line 80, in _run
      self._context.run(self._callback, *self._args)
    File "/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py", line 685, in <lambda>
      lambda f: self._run_callback(functools.partial(callback, future))
    File "/usr/local/lib/python3.10/dist-packages/tornado/ioloop.py", line 738, in _run_callback
      ret = callback()
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 825, in inner
      self.ctx_run(self.run)
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 786, in run
      yielded = self.gen.send(value)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py", line 377, in dispatch_queue
      yield self.process_one()
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 250, in wrapper
      runner = Runner(ctx_run, result, future, yielded)
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 748, in __init__
      self.ctx_run(self.run)
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 786, in run
      yielded = self.gen.send(value)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py", line 361, in process_one
      yield gen.maybe_future(dispatch(*args))
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py", line 261, in dispatch_shell
      yield gen.maybe_future(handler(stream, idents, msg))
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/kernelbase.py", line 539, in execute_request
      self.do_execute(
    File "/usr/local/lib/python3.10/dist-packages/tornado/gen.py", line 234, in wrapper
      yielded = ctx_run(next, result)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/ipkernel.py", line 302, in do_execute
      res = shell.run_cell(code, store_history=store_history, silent=silent)
    File "/usr/local/lib/python3.10/dist-packages/ipykernel/zmqshell.py", line 539, in run_cell
      return super(ZMQInteractiveShell, self).run_cell(*args, **kwargs)
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py", line 2975, in run_cell
      result = self._run_cell(
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py", line 3030, in _run_cell
      return runner(coro)
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/async_helpers.py", line 78, in _pseudo_sync_runner
      coro.send(None)
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py", line 3257, in run_cell_async
      has_raised = await self.run_ast_nodes(code_ast.body, cell_name,
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py", line 3473, in run_ast_nodes
      if (await self.run_code(code, result,  async_=asy)):
    File "/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py", line 3553, in run_code
      exec(code_obj, self.user_global_ns, self.user_ns)
    File "<ipython-input-4-48b082c0deba>", line 42, in <cell line: 42>
      model.fit(train_images, train_masks, epochs=epoch, batch_size=batch_size,
    File "/usr/local/lib/python3.10/dist-packages/keras/utils/traceback_utils.py", line 65, in error_handler
      return fn(*args, **kwargs)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1685, in fit
      tmp_logs = self.train_function(iterator)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1284, in train_function
      return step_function(self, iterator)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1268, in step_function
      outputs = model.distribute_strategy.run(run_step, args=(data,))
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1249, in run_step
      outputs = model.train_step(data)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1051, in train_step
      loss = self.compute_loss(x, y, y_pred, sample_weight)
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/training.py", line 1109, in compute_loss
      return self.compiled_loss(
    File "/usr/local/lib/python3.10/dist-packages/keras/engine/compile_utils.py", line 265, in __call__
      loss_value = loss_obj(y_t, y_p, sample_weight=sw)
    File "/usr/local/lib/python3.10/dist-packages/keras/losses.py", line 160, in __call__
      return losses_utils.compute_weighted_loss(
    File "/usr/local/lib/python3.10/dist-packages/keras/utils/losses_utils.py", line 351, in compute_weighted_loss
      weighted_losses = tf.multiply(losses, sample_weight)
Node: 'binary_crossentropy/weighted_loss/Mul'
required broadcastable shapes
	 [[{{node binary_crossentropy/weighted_loss/Mul}}]] [Op:__inference_train_function_6481]

==================================================================================================

se espando la dimensione delle maschere nel fit ma non nel metodo che espande le maschere( add_sample_weights() )
ovvero con :

train_masks_exp = tf.expand_dims(train_masks, axis=-1)
model.fit(train_images, train_masks_exp, epochs=epoch, batch_size=batch_size,
          callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks,weights),
          validation_data=(val_images, val_masks))

NON HO errori ed
nella parte di train:
Epoch 1/300
11/11 [==============================] - 32s 878ms/step - loss: 1.5050 - accuracy: 0.9618 - val_loss: 0.1376 - val_accuracy: 0.9772
Epoch 2/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0877 - accuracy: 0.9618 - val_loss: 0.1216 - val_accuracy: 0.9772
Epoch 3/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0874 - accuracy: 0.9618 - val_loss: 0.1208 - val_accuracy: 0.9772
Epoch 4/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0854 - accuracy: 0.9618 - val_loss: 0.1202 - val_accuracy: 0.9772
Epoch 5/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0857 - accuracy: 0.9618 - val_loss: 0.1171 - val_accuracy: 0.9772
Epoch 6/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0852 - accuracy: 0.9618 - val_loss: 0.1284 - val_accuracy: 0.9772
Epoch 7/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0853 - accuracy: 0.9618 - val_loss: 0.1273 - val_accuracy: 0.9772
Epoch 8/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0849 - accuracy: 0.9618 - val_loss: 0.1234 - val_accuracy: 0.9772
Epoch 9/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0838 - accuracy: 0.9618 - val_loss: 0.1216 - val_accuracy: 0.9772
Epoch 10/300
11/11 [==============================] - 2s 159ms/step - loss: 0.0837 - accuracy: 0.9618 - val_loss: 0.1157 - val_accuracy: 0.9772
Epoch 11/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0850 - accuracy: 0.9618 - val_loss: 0.1155 - val_accuracy: 0.9772
Epoch 12/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0843 - accuracy: 0.9618 - val_loss: 0.1197 - val_accuracy: 0.9772
Epoch 13/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0833 - accuracy: 0.9618 - val_loss: 0.1202 - val_accuracy: 0.9772
Epoch 14/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0834 - accuracy: 0.9618 - val_loss: 0.1166 - val_accuracy: 0.9772
Epoch 15/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0860 - accuracy: 0.9618 - val_loss: 0.1220 - val_accuracy: 0.9772
Epoch 16/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0846 - accuracy: 0.9618 - val_loss: 0.1254 - val_accuracy: 0.9772
Epoch 17/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0833 - accuracy: 0.9618 - val_loss: 0.1230 - val_accuracy: 0.9772
Epoch 18/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0820 - accuracy: 0.9618 - val_loss: 0.1178 - val_accuracy: 0.9772
Epoch 19/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0823 - accuracy: 0.9618 - val_loss: 0.1117 - val_accuracy: 0.9772
Epoch 20/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0829 - accuracy: 0.9618 - val_loss: 0.1199 - val_accuracy: 0.9772
Epoch 21/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0813 - accuracy: 0.9618 - val_loss: 0.1133 - val_accuracy: 0.9772
Epoch 22/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0815 - accuracy: 0.9618 - val_loss: 0.1143 - val_accuracy: 0.9772
Epoch 23/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0816 - accuracy: 0.9618 - val_loss: 0.1130 - val_accuracy: 0.9772
Epoch 24/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0804 - accuracy: 0.9618 - val_loss: 0.1212 - val_accuracy: 0.9772
Epoch 25/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0808 - accuracy: 0.9618 - val_loss: 0.1154 - val_accuracy: 0.9772
Epoch 26/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0802 - accuracy: 0.9618 - val_loss: 0.1141 - val_accuracy: 0.9772
Epoch 27/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0794 - accuracy: 0.9618 - val_loss: 0.1211 - val_accuracy: 0.9772
Epoch 28/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0806 - accuracy: 0.9618 - val_loss: 0.1102 - val_accuracy: 0.9772
Epoch 29/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0802 - accuracy: 0.9618 - val_loss: 0.1121 - val_accuracy: 0.9772
Epoch 30/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0794 - accuracy: 0.9618 - val_loss: 0.1149 - val_accuracy: 0.9772
Epoch 31/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0792 - accuracy: 0.9618 - val_loss: 0.1108 - val_accuracy: 0.9772
Epoch 32/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0797 - accuracy: 0.9618 - val_loss: 0.1142 - val_accuracy: 0.9772
Epoch 33/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0798 - accuracy: 0.9618 - val_loss: 0.1115 - val_accuracy: 0.9772
Epoch 34/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0803 - accuracy: 0.9618 - val_loss: 0.1134 - val_accuracy: 0.9772
Epoch 35/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0793 - accuracy: 0.9618 - val_loss: 0.1119 - val_accuracy: 0.9772
Epoch 36/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0781 - accuracy: 0.9618 - val_loss: 0.1128 - val_accuracy: 0.9772
Epoch 37/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0789 - accuracy: 0.9617 - val_loss: 0.1199 - val_accuracy: 0.9771
Epoch 38/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0783 - accuracy: 0.9618 - val_loss: 0.1127 - val_accuracy: 0.9772
Epoch 39/300
11/11 [==============================] - 2s 166ms/step - loss: 0.0777 - accuracy: 0.9618 - val_loss: 0.1129 - val_accuracy: 0.9772
Epoch 40/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0780 - accuracy: 0.9618 - val_loss: 0.1140 - val_accuracy: 0.9772
Epoch 41/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0790 - accuracy: 0.9618 - val_loss: 0.1132 - val_accuracy: 0.9772
Epoch 42/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0809 - accuracy: 0.9618 - val_loss: 0.1141 - val_accuracy: 0.9772
Epoch 43/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0777 - accuracy: 0.9619 - val_loss: 0.1151 - val_accuracy: 0.9772
Epoch 44/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0785 - accuracy: 0.9622 - val_loss: 0.1137 - val_accuracy: 0.9772
Epoch 45/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0783 - accuracy: 0.9622 - val_loss: 0.1098 - val_accuracy: 0.9772
Epoch 46/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0784 - accuracy: 0.9619 - val_loss: 0.1128 - val_accuracy: 0.9772
Epoch 47/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0775 - accuracy: 0.9621 - val_loss: 0.1165 - val_accuracy: 0.9772
Epoch 48/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0772 - accuracy: 0.9618 - val_loss: 0.1237 - val_accuracy: 0.9772
Epoch 49/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0757 - accuracy: 0.9619 - val_loss: 0.1131 - val_accuracy: 0.9772
Epoch 50/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0771 - accuracy: 0.9625 - val_loss: 0.1130 - val_accuracy: 0.9772
Epoch 51/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0763 - accuracy: 0.9623 - val_loss: 0.1138 - val_accuracy: 0.9772
Epoch 52/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0745 - accuracy: 0.9621 - val_loss: 0.1125 - val_accuracy: 0.9772
Epoch 53/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0748 - accuracy: 0.9620 - val_loss: 0.1158 - val_accuracy: 0.9772
Epoch 54/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0764 - accuracy: 0.9619 - val_loss: 0.1199 - val_accuracy: 0.9772
Epoch 55/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0758 - accuracy: 0.9623 - val_loss: 0.1241 - val_accuracy: 0.9772
Epoch 56/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0735 - accuracy: 0.9623 - val_loss: 0.1191 - val_accuracy: 0.9771
Epoch 57/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0720 - accuracy: 0.9628 - val_loss: 0.1168 - val_accuracy: 0.9772
Epoch 58/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0731 - accuracy: 0.9623 - val_loss: 0.1246 - val_accuracy: 0.9769
Epoch 59/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0711 - accuracy: 0.9631 - val_loss: 0.1175 - val_accuracy: 0.9772
Epoch 60/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0715 - accuracy: 0.9632 - val_loss: 0.1149 - val_accuracy: 0.9772
Epoch 61/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0722 - accuracy: 0.9623 - val_loss: 0.1164 - val_accuracy: 0.9761
Epoch 62/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0694 - accuracy: 0.9634 - val_loss: 0.1268 - val_accuracy: 0.9729
Epoch 63/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0709 - accuracy: 0.9632 - val_loss: 0.1186 - val_accuracy: 0.9762
Epoch 64/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0750 - accuracy: 0.9629 - val_loss: 0.1200 - val_accuracy: 0.9768
Epoch 65/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0761 - accuracy: 0.9630 - val_loss: 0.1185 - val_accuracy: 0.9772
Epoch 66/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0762 - accuracy: 0.9630 - val_loss: 0.1169 - val_accuracy: 0.9757
Epoch 67/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0716 - accuracy: 0.9626 - val_loss: 0.1165 - val_accuracy: 0.9771
Epoch 68/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0698 - accuracy: 0.9644 - val_loss: 0.1164 - val_accuracy: 0.9769
Epoch 69/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0691 - accuracy: 0.9643 - val_loss: 0.1219 - val_accuracy: 0.9761
Epoch 70/300
11/11 [==============================] - 2s 148ms/step - loss: 0.0739 - accuracy: 0.9623 - val_loss: 0.1139 - val_accuracy: 0.9772
Epoch 71/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0693 - accuracy: 0.9637 - val_loss: 0.1210 - val_accuracy: 0.9767
Epoch 72/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0670 - accuracy: 0.9649 - val_loss: 0.1189 - val_accuracy: 0.9757
Epoch 73/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0666 - accuracy: 0.9650 - val_loss: 0.1150 - val_accuracy: 0.9765
Epoch 74/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0649 - accuracy: 0.9652 - val_loss: 0.1226 - val_accuracy: 0.9752
Epoch 75/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0614 - accuracy: 0.9659 - val_loss: 0.1214 - val_accuracy: 0.9760
Epoch 76/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0597 - accuracy: 0.9670 - val_loss: 0.1225 - val_accuracy: 0.9748
Epoch 77/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0580 - accuracy: 0.9673 - val_loss: 0.1245 - val_accuracy: 0.9746
Epoch 78/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0573 - accuracy: 0.9675 - val_loss: 0.1271 - val_accuracy: 0.9753
Epoch 79/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0575 - accuracy: 0.9665 - val_loss: 0.1259 - val_accuracy: 0.9753
Epoch 80/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0528 - accuracy: 0.9686 - val_loss: 0.1273 - val_accuracy: 0.9753
Epoch 81/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0554 - accuracy: 0.9678 - val_loss: 0.1295 - val_accuracy: 0.9749
Epoch 82/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0549 - accuracy: 0.9684 - val_loss: 0.1303 - val_accuracy: 0.9752
Epoch 83/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0524 - accuracy: 0.9688 - val_loss: 0.1292 - val_accuracy: 0.9770
Epoch 84/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0510 - accuracy: 0.9698 - val_loss: 0.1262 - val_accuracy: 0.9767
Epoch 85/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0516 - accuracy: 0.9695 - val_loss: 0.1365 - val_accuracy: 0.9732
Epoch 86/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0457 - accuracy: 0.9721 - val_loss: 0.1432 - val_accuracy: 0.9723
Epoch 87/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0430 - accuracy: 0.9740 - val_loss: 0.1483 - val_accuracy: 0.9732
Epoch 88/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0386 - accuracy: 0.9759 - val_loss: 0.1459 - val_accuracy: 0.9736
Epoch 89/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0370 - accuracy: 0.9761 - val_loss: 0.1604 - val_accuracy: 0.9657
Epoch 90/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0365 - accuracy: 0.9764 - val_loss: 0.1590 - val_accuracy: 0.9720
Epoch 91/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0367 - accuracy: 0.9761 - val_loss: 0.1524 - val_accuracy: 0.9733
Epoch 92/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0398 - accuracy: 0.9740 - val_loss: 0.1502 - val_accuracy: 0.9707
Epoch 93/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0386 - accuracy: 0.9748 - val_loss: 0.1566 - val_accuracy: 0.9726
Epoch 94/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0364 - accuracy: 0.9764 - val_loss: 0.1538 - val_accuracy: 0.9674
Epoch 95/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0335 - accuracy: 0.9777 - val_loss: 0.1618 - val_accuracy: 0.9714

NELLA PREDIZIONE:
6/6 [==============================] - 3s 121ms/step
============================================================================
Prediction : TEST 

Evaluation Metrics:
Precision: 0.018339874555258043
Recall: 0.723589001447178
F1-score: 0.035773055734420835
Mean IoU: 0.17810604294013532
Confusion Matrix:
 [[ 55048 107052]
 [   764   2000]]
precision_attacchi:  0.723589001447178
precision_normali:  0.33959284392350403
F1 attacchi: 0.035773055734420835
F1 normali: 0.5052314695840523
Macro F1: 0.27050226265923655
OA: 0.34603066770186336
21/21 [==============================] - 2s 86ms/step
============================================================================
Prediction : TRAIN 

Evaluation Metrics:
Precision: 0.04272242246886264
Recall: 0.8139900556712422
F1-score: 0.08118389291897929
Mean IoU: 0.1879256216831984
Confusion Matrix:
 [[216983 429182]
 [  4377  19154]]
precision_attacchi:  0.8139900556712422
precision_normali:  0.33580122724072026
F1 attacchi: 0.08118389291897929
F1 normali: 0.5002345753724676
Macro F1: 0.29070923414572347
OA: 0.3526032707377676

per omogenita del codice , forse sbaglio, credo sia meglio usare solo le maschere con l'espansione di dimensione
ovvero sia come paramentro nel fit in quando obbligatorio per non avvere l'errore precedentemente mostrato
sia nel metodo add_sample_weights()
ed usare ho scelto la versione mostrata all'inizio di questo file, ovvero:
train_masks_exp = tf.expand_dims(train_masks, axis=-1)
model.fit(train_images, train_masks_exp, epochs=epoch, batch_size=batch_size,
          callbacks=[early_stopping],sample_weight=add_sample_weights(train_masks_exp,weights),
          validation_data=(val_images, val_masks))

IN QUANTO NELLA DOCUMENTAIONE di tensorflow considerava un esempio di allenamento con maschere ad ogni pixel 3 possibili valori
(credo 3 classi)
il link è https://www.tensorflow.org/tutorials/images/segmentation?hl=it#optional_imbalanced_classes_and_class_weights
(il link è lo stesso mostrato all'inizio di questo file)

ed nel train ho :
Epoch 1/300
11/11 [==============================] - 31s 792ms/step - loss: 1.5745 - accuracy: 0.8741 - val_loss: 0.1332 - val_accuracy: 0.9772
Epoch 2/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0993 - accuracy: 0.9618 - val_loss: 0.1222 - val_accuracy: 0.9772
Epoch 3/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0874 - accuracy: 0.9618 - val_loss: 0.1252 - val_accuracy: 0.9772
Epoch 4/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0857 - accuracy: 0.9618 - val_loss: 0.1194 - val_accuracy: 0.9772
Epoch 5/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0860 - accuracy: 0.9618 - val_loss: 0.1174 - val_accuracy: 0.9772
Epoch 6/300
11/11 [==============================] - 2s 160ms/step - loss: 0.0843 - accuracy: 0.9618 - val_loss: 0.1160 - val_accuracy: 0.9772
Epoch 7/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0846 - accuracy: 0.9618 - val_loss: 0.1190 - val_accuracy: 0.9772
Epoch 8/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0835 - accuracy: 0.9618 - val_loss: 0.1184 - val_accuracy: 0.9772
Epoch 9/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0843 - accuracy: 0.9618 - val_loss: 0.1269 - val_accuracy: 0.9772
Epoch 10/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0843 - accuracy: 0.9618 - val_loss: 0.1407 - val_accuracy: 0.9772
Epoch 11/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0845 - accuracy: 0.9618 - val_loss: 0.1199 - val_accuracy: 0.9772
Epoch 12/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0827 - accuracy: 0.9618 - val_loss: 0.1179 - val_accuracy: 0.9772
Epoch 13/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0830 - accuracy: 0.9618 - val_loss: 0.1171 - val_accuracy: 0.9772
Epoch 14/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0831 - accuracy: 0.9618 - val_loss: 0.1182 - val_accuracy: 0.9772
Epoch 15/300
11/11 [==============================] - 2s 160ms/step - loss: 0.0820 - accuracy: 0.9618 - val_loss: 0.1145 - val_accuracy: 0.9772
Epoch 16/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0836 - accuracy: 0.9618 - val_loss: 0.1174 - val_accuracy: 0.9772
Epoch 17/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0840 - accuracy: 0.9618 - val_loss: 0.1260 - val_accuracy: 0.9772
Epoch 18/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0862 - accuracy: 0.9618 - val_loss: 0.1317 - val_accuracy: 0.9772
Epoch 19/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0874 - accuracy: 0.9618 - val_loss: 0.1205 - val_accuracy: 0.9772
Epoch 20/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0846 - accuracy: 0.9618 - val_loss: 0.1178 - val_accuracy: 0.9772
Epoch 21/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0823 - accuracy: 0.9618 - val_loss: 0.1135 - val_accuracy: 0.9772
Epoch 22/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0823 - accuracy: 0.9618 - val_loss: 0.1158 - val_accuracy: 0.9772
Epoch 23/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0816 - accuracy: 0.9618 - val_loss: 0.1143 - val_accuracy: 0.9772
Epoch 24/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0819 - accuracy: 0.9618 - val_loss: 0.1121 - val_accuracy: 0.9772
Epoch 25/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0816 - accuracy: 0.9618 - val_loss: 0.1121 - val_accuracy: 0.9772
Epoch 26/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0842 - accuracy: 0.9618 - val_loss: 0.1141 - val_accuracy: 0.9772
Epoch 27/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0820 - accuracy: 0.9618 - val_loss: 0.1176 - val_accuracy: 0.9772
Epoch 28/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0809 - accuracy: 0.9618 - val_loss: 0.1136 - val_accuracy: 0.9772
Epoch 29/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0795 - accuracy: 0.9618 - val_loss: 0.1252 - val_accuracy: 0.9772
Epoch 30/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0809 - accuracy: 0.9618 - val_loss: 0.1425 - val_accuracy: 0.9772
Epoch 31/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0830 - accuracy: 0.9618 - val_loss: 0.1267 - val_accuracy: 0.9772
Epoch 32/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0810 - accuracy: 0.9618 - val_loss: 0.1163 - val_accuracy: 0.9772
Epoch 33/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0801 - accuracy: 0.9618 - val_loss: 0.1164 - val_accuracy: 0.9772
Epoch 34/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0794 - accuracy: 0.9618 - val_loss: 0.1174 - val_accuracy: 0.9772
Epoch 35/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0791 - accuracy: 0.9618 - val_loss: 0.1196 - val_accuracy: 0.9772
Epoch 36/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0797 - accuracy: 0.9617 - val_loss: 0.1122 - val_accuracy: 0.9772
Epoch 37/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0787 - accuracy: 0.9618 - val_loss: 0.1122 - val_accuracy: 0.9772
Epoch 38/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0780 - accuracy: 0.9618 - val_loss: 0.1130 - val_accuracy: 0.9772
Epoch 39/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0772 - accuracy: 0.9618 - val_loss: 0.1150 - val_accuracy: 0.9772
Epoch 40/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0779 - accuracy: 0.9618 - val_loss: 0.1163 - val_accuracy: 0.9772
Epoch 41/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0792 - accuracy: 0.9618 - val_loss: 0.1155 - val_accuracy: 0.9772
Epoch 42/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0776 - accuracy: 0.9618 - val_loss: 0.1131 - val_accuracy: 0.9772
Epoch 43/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0764 - accuracy: 0.9618 - val_loss: 0.1159 - val_accuracy: 0.9771
Epoch 44/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0789 - accuracy: 0.9617 - val_loss: 0.1130 - val_accuracy: 0.9772
Epoch 45/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0781 - accuracy: 0.9618 - val_loss: 0.1132 - val_accuracy: 0.9772
Epoch 46/300
11/11 [==============================] - 2s 158ms/step - loss: 0.0761 - accuracy: 0.9618 - val_loss: 0.1119 - val_accuracy: 0.9772
Epoch 47/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0739 - accuracy: 0.9618 - val_loss: 0.1141 - val_accuracy: 0.9772
Epoch 48/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0759 - accuracy: 0.9619 - val_loss: 0.1178 - val_accuracy: 0.9772
Epoch 49/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0735 - accuracy: 0.9625 - val_loss: 0.1165 - val_accuracy: 0.9768
Epoch 50/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0741 - accuracy: 0.9624 - val_loss: 0.1155 - val_accuracy: 0.9772
Epoch 51/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0771 - accuracy: 0.9620 - val_loss: 0.1293 - val_accuracy: 0.9760
Epoch 52/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0723 - accuracy: 0.9626 - val_loss: 0.1167 - val_accuracy: 0.9769
Epoch 53/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0699 - accuracy: 0.9629 - val_loss: 0.1142 - val_accuracy: 0.9769
Epoch 54/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0692 - accuracy: 0.9631 - val_loss: 0.1210 - val_accuracy: 0.9772
Epoch 55/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0673 - accuracy: 0.9627 - val_loss: 0.1188 - val_accuracy: 0.9748
Epoch 56/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0679 - accuracy: 0.9633 - val_loss: 0.1155 - val_accuracy: 0.9751
Epoch 57/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0712 - accuracy: 0.9631 - val_loss: 0.1155 - val_accuracy: 0.9771
Epoch 58/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0664 - accuracy: 0.9627 - val_loss: 0.1224 - val_accuracy: 0.9764
Epoch 59/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0659 - accuracy: 0.9647 - val_loss: 0.1180 - val_accuracy: 0.9763
Epoch 60/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0645 - accuracy: 0.9649 - val_loss: 0.1208 - val_accuracy: 0.9747
Epoch 61/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0625 - accuracy: 0.9651 - val_loss: 0.1175 - val_accuracy: 0.9766
Epoch 62/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0611 - accuracy: 0.9656 - val_loss: 0.1188 - val_accuracy: 0.9760
Epoch 63/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0598 - accuracy: 0.9663 - val_loss: 0.1316 - val_accuracy: 0.9726
Epoch 64/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0565 - accuracy: 0.9674 - val_loss: 0.1228 - val_accuracy: 0.9762
Epoch 65/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0547 - accuracy: 0.9673 - val_loss: 0.1364 - val_accuracy: 0.9680
Epoch 66/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0551 - accuracy: 0.9669 - val_loss: 0.1202 - val_accuracy: 0.9765
Epoch 67/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0559 - accuracy: 0.9669 - val_loss: 0.1264 - val_accuracy: 0.9759
Epoch 68/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0508 - accuracy: 0.9691 - val_loss: 0.1220 - val_accuracy: 0.9750
Epoch 69/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0499 - accuracy: 0.9686 - val_loss: 0.1315 - val_accuracy: 0.9756
Epoch 70/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0501 - accuracy: 0.9693 - val_loss: 0.1352 - val_accuracy: 0.9731
Epoch 71/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0466 - accuracy: 0.9715 - val_loss: 0.1397 - val_accuracy: 0.9701
Epoch 72/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0434 - accuracy: 0.9721 - val_loss: 0.1378 - val_accuracy: 0.9767
Epoch 73/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0411 - accuracy: 0.9732 - val_loss: 0.1417 - val_accuracy: 0.9757
Epoch 74/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0402 - accuracy: 0.9739 - val_loss: 0.1425 - val_accuracy: 0.9722
Epoch 75/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0391 - accuracy: 0.9740 - val_loss: 0.1523 - val_accuracy: 0.9722
Epoch 76/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0363 - accuracy: 0.9751 - val_loss: 0.1620 - val_accuracy: 0.9747
Epoch 77/300
11/11 [==============================] - 2s 154ms/step - loss: 0.0346 - accuracy: 0.9758 - val_loss: 0.1625 - val_accuracy: 0.9741
Epoch 78/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0335 - accuracy: 0.9760 - val_loss: 0.1521 - val_accuracy: 0.9733
Epoch 79/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0307 - accuracy: 0.9779 - val_loss: 0.1799 - val_accuracy: 0.9752
Epoch 80/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0288 - accuracy: 0.9781 - val_loss: 0.1773 - val_accuracy: 0.9731
Epoch 81/300
11/11 [==============================] - 2s 156ms/step - loss: 0.0291 - accuracy: 0.9782 - val_loss: 0.1851 - val_accuracy: 0.9690
Epoch 82/300
11/11 [==============================] - 2s 155ms/step - loss: 0.0315 - accuracy: 0.9765 - val_loss: 0.1787 - val_accuracy: 0.9719
Epoch 83/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0296 - accuracy: 0.9780 - val_loss: 0.1689 - val_accuracy: 0.9742
Epoch 84/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0267 - accuracy: 0.9795 - val_loss: 0.1796 - val_accuracy: 0.9741
Epoch 85/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0252 - accuracy: 0.9810 - val_loss: 0.1990 - val_accuracy: 0.9737
Epoch 86/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0270 - accuracy: 0.9793 - val_loss: 0.1805 - val_accuracy: 0.9750
Epoch 87/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0248 - accuracy: 0.9810 - val_loss: 0.1739 - val_accuracy: 0.9736
Epoch 88/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0241 - accuracy: 0.9815 - val_loss: 0.1967 - val_accuracy: 0.9720
Epoch 89/300
11/11 [==============================] - 2s 157ms/step - loss: 0.0223 - accuracy: 0.9823 - val_loss: 0.2198 - val_accuracy: 0.9726
Epoch 90/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0204 - accuracy: 0.9837 - val_loss: 0.2148 - val_accuracy: 0.9738
Epoch 91/300
11/11 [==============================] - 2s 153ms/step - loss: 0.0190 - accuracy: 0.9849 - val_loss: 0.2134 - val_accuracy: 0.9746
Epoch 92/300
11/11 [==============================] - 2s 150ms/step - loss: 0.0193 - accuracy: 0.9844 - val_loss: 0.2295 - val_accuracy: 0.9724
Epoch 93/300
11/11 [==============================] - 2s 149ms/step - loss: 0.0181 - accuracy: 0.9853 - val_loss: 0.2336 - val_accuracy: 0.9728
Epoch 94/300
11/11 [==============================] - 2s 152ms/step - loss: 0.0166 - accuracy: 0.9866 - val_loss: 0.2525 - val_accuracy: 0.9731
Epoch 95/300
11/11 [==============================] - 2s 151ms/step - loss: 0.0157 - accuracy: 0.9874 - val_loss: 0.2401 - val_accuracy: 0.9690
Epoch 96/300
11/11 [==============================] - 2s 161ms/step - loss: 0.0148 - accuracy: 0.9881 - val_loss: 0.2648 - val_accuracy: 0.9736

NELLA PREDIZIONE:
6/6 [==============================] - 3s 120ms/step
============================================================================
Prediction : TEST 

Evaluation Metrics:
Precision: 0.018339874555258043
Recall: 0.723589001447178
F1-score: 0.035773055734420835
Mean IoU: 0.17810604294013532
Confusion Matrix:
 [[ 55048 107052]
 [   764   2000]]
precision_attacchi:  0.723589001447178
precision_normali:  0.33959284392350403
F1 attacchi: 0.035773055734420835
F1 normali: 0.5052314695840523
Macro F1: 0.27050226265923655
OA: 0.34603066770186336
21/21 [==============================] - 2s 86ms/step
============================================================================
Prediction : TRAIN 

Evaluation Metrics:
Precision: 0.04272242246886264
Recall: 0.8139900556712422
F1-score: 0.08118389291897929
Mean IoU: 0.1879256216831984
Confusion Matrix:
 [[216983 429182]
 [  4377  19154]]
precision_attacchi:  0.8139900556712422
precision_normali:  0.33580122724072026
F1 attacchi: 0.08118389291897929
F1 normali: 0.5002345753724676
Macro F1: 0.29070923414572347
OA: 0.3526032707377676



